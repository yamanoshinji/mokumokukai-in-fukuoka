# 勉強会記録：もくもく会in福岡支社

## 1. 概要
- 日付：2025/11/11/
- 内容：JavaオンプレシステムのAWS移行（NATゲートウェイ構築）
- 参考記事：
  - [Qiita：【AWS】VPC・EC2 作成 ハンズオン](https://qiita.com/zeems/items/1d97d42a99936885ca4a)
  - [Qiita：手軽に学ぶ！初心者向けJavaアプリのAWSデプロイ方法。Eclipse、Tomcat、Apacheで始めるクラウド運用。](https://qiita.com/shuncask/items/779d8e92cc7af63aaa94)

## 2. 学んだこと（議論になったところ中心）
- 仮想サーバ（EC2）の構築
  - EC2
  - NATゲートウェイ
    - プライベートサブネットからインターネットへのアクセスを可能にするコンポーネント
    - NATゲートウェイ自体はパブリックサブネットに配置する
    - NATゲートウェイは時間単位、処理データ1GB単位で料金が発生する
![alt text](image.png)
- 独り言
  - 今回プライベートサブネットのEC2に構築するのはDBサーバのみの予定なので、NATゲートウェイは不要？
  ⇒パッケージの更新や外部にデータ送信したりOSをアップデートしたりしないなら不必要
  　⇒ないとは言い切れないけど、外部からの通信が返ってこないのに↑できるの？
  　　⇒アクセスした場所からのレスポンス通信のみは返ってくるので可能。
  　　　NATゲートウェイがコネクション（通信の組み合わせ）を内部でステートフルに記録している
  - 動作イメージ
    ```
    (内部)10.0.2.15:54321 → NAT → 151.101.xx.xx:443(外部)
    NATがテーブルに記録：
    10.0.2.15:54321 ↔ 54.x.x.x:60001 ↔ 151.101.xx.xx:443
    ↓ 外部レスポンスが到着
    151.101.xx.xx:443 → 54.x.x.x:60001
    NATはテーブルを参照
    → 一致！
    → DBサーバへ転送（OK）
    ```
  - 未知の通信
    ```
    151.101.xx.xx → 54.x.x.x:99999 (テーブルにない)
    → NATがはじく
    ```

- 反省
  - ちょっと時間なくて焦ってた感ある笑
  - もっかい落ち着いて記事通り一個ずつやりたい
    - https://qiita.com/zeems/items/1d97d42a99936885ca4a#nat%E3%82%B2%E3%83%BC%E3%83%88%E3%82%A6%E3%82%A7%E3%82%A4%E4%BD%9C%E6%88%90


